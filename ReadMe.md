# simulate.py

This script generates a co‐enrollment LP for a given number of courses and writes it to `<size>.lp`.

## Prerequisites

* Python 3.7+
* `pandas`
* `numpy`
* `gurobipy` (with valid license parameters set in the script)
* `anon_coenrol.csv` and `hist_totals.csv` in the working directory

## Installation

```bash
# (Optionally) create a virtual env
python3 -m venv venv
source venv/bin/activate

# Install required packages
pip install pandas numpy gurobipy
```

## Usage

```bash
# Basic: schedule 20 courses
python simulate.py 20

# With custom RNG seed
python simulate.py 20 --seed 42
```

This will:

1. Read `anon_coenrol.csv` & `hist_totals.csv`.
2. Sample pairwise co-enrollments for the top-20 (or random extra) course IDs.
3. Build and write the LP model to `20.lp`.
4. Print a stats summary, e.g.:

```
Done. LP ⇒ 20.lp, stats: {
  "samples": 80,
  "weighted": 56,
  "random": 24,
  "unique": 78,
  "max": 5
}
```

---

## Runtime Benchmark Table

Use the table below to record how long `simulate.py` takes for different `size` values. You can measure runtime in bash, e.g.:

```bash
time python simulate.py 50
```

| Size  | Runtime (s) | 
| :--:  | :---------: | 
|  200  |    438      |     
|  300  |    523      |  
|  400  |    2207         |  
|  500  |    10829       |   
|  600  |    32256         |   




## Files

* `simulate_seq.py`: Main simulation + scheduling driver.
* `anon24.csv`: Mapping from (anon) exam groups to block numbers.
* `anon_t_co.csv`, `exam_map.csv`: Auto-generated by `setup()` on first run.
* `anon_coenrol.csv`: Pairwise co-enrollment counts.

## Usage

Run the simulation & optimization in one command:

```bash
python simulate_seq.py <size> [--seed SEED] [--slots SLOTS]
```

* `<size>`: Number of (anonymous) courses to simulate (e.g. `300`). Increasing this increases the model size polynomially, so don't go above 1000 unless you have alot of RAM. 
* `--seed SEED`: Random seed for reproducibility (default: `3`).
* `--slots SLOTS`: Number of time slots (blocks) to use (default: `24`). This must be more than 24. 
* `--slow SLOW` : Whether the IP is slow or not. If this is False the largest IPs will take 5ish minutes. If Slow it will take many hours. The timelimit is 10 hours 

**Example:**

```bash
python simulate_seq.py 300 --seed 42 --slots 24 --slow True 
```

## Benchmark Table
These are runs on my computer using gurobipy and python 3.11. 

| Size | Slots | Slow |   Runtime (s)  |
| ---- | ----- | ----------- |----|
| 200  | 24    | False       |  94  |
| 400  | 24    | False       |  170 |
| 200  | 34    | False       |  979 |
| 400  | 34    | False       |  400 |
| 200  | 44    | False       |  1595   |
| 200  | 24    | True        |  5+ hours    |
| 400  | 24    | True        |  5+ hours    |



